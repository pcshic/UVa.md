title: 'Reverse Prime'
date: 2015-12-28 19:35:58
probid: 11610
uvaid: 2657
translator: "許胖"
transource: "uniDog"
categories:
- "Volume - 116"
tags:
- "動態區間查詢問題"
- "質因數分解"
- "線段樹"
---

有一些七位數的正整數，其左右相反是質數，且小於 {% math %}10^6{% endmath %}。例如：{% math %}1000070{% endmath %}、{% math %}1000090{% endmath %}、{% math %}1000240{% endmath %} 是前幾個顛倒質數 (reverse prime)，因為他們都是七位數，而且左右相反後是一個小於 {% math %}10^6{% endmath %} 的質數。你必須找出所有七位數顛倒質數和他質因數的個數。一個整數的質因數是質數且剛好整除該數，例如 24 的質因數有 2、2、2 和 3。

<!-- more -->

## Input ##

在這個問題中，你會遇到兩種輸入：

- ** 查詢 **：這種輸入格式為 `q i`
- ** 刪除 **：這種輸入的格式為 `d 顛倒質數`

輸入保證 `i` 會是合法的足標，且顛倒質數也會是合法的 7 位顛倒質數，且輸入中也不會有兩個相同的顛倒質數。

測資中最多會有 71000 個查詢和 3500 個刪除操作，程式會以 `EOF` 作為結束。

## Output ##

對於查詢操作，你必須計算出第 {% math %}0{% endmath %} 個到第 {% math %}i-1{% endmath %} 個顛倒質數中所有質因數的數量和。

對於刪除操作，你必須刪除集合內的顛倒質數並且更新您的質因數數量和，此狀況沒有輸出。

## Sample Input ##

	q 0
	q 1
	q 2
	d 1000070
	d 1000090
	q 0
	d 1000240
	q 0
	q 1

## Sample Output ##

	4
	10
	16
	6
	3
	7