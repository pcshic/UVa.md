title: "114 - Simulation Wizardry"
probid: 114
uvaid: 50
categories: "Volume - 001"
tags:
---

## Background ##

在電腦科學的領域裡，模擬是個相當重要的應用，利用電腦來讓我們能一窺 真實世界裡的事情，包括許多如離散事件和動態時間事件等。 模擬常用在逼近已觀察到的行為模式以找尋較好的可能。

這個問題是有關模擬一個已被簡化的彈珠檯。在這台彈珠檯裡，鋼珠在上面滾來滾去， 撞擊不同的物品（ 彈力條 (bumper) ）以得到分數，直到這顆珠子 「消失」為止。

你要寫個程式來模擬一個理想化的彈珠檯，這個彈珠檯有著平滑的表面，上面附有障礙物彈力條 (bumper) 和牆 (wall)。我們將此檯面視為 $ m \times n $ 個單位長的矩形，其中原點在左下角。 對於每個彈力條而言，其恰好佔掉一個格子點，而牆則在檯面四周邊界的格子點上。(即矩形的邊界上)每次會有一顆珠子射出(出現)到檯面上，其帶有「初始位置」、「初始運動方向」、 「生命值」(lifetime)三種屬性。在本問題的模擬狀況裡，珠子的位置都會在格子點 上，而且只有四個運動方向：上、下、左、右。珠子在檯面上的格子點彈跳，撞擊著 彈力條(可以得到分數)和牆(怎樣撞也沒分數)。打到這個彈力條所得到的分數 即稱此彈力條的「價值 (value)」。珠子在每個單位時間間隔內可以 移動一個單位長 (one grid space per timestep)；如果珠子在這個時間 間隔內能夠滾到某個障礙物（牆或彈力條）所在的格子點上（假設此障礙物不存在時）， 我們就說珠子在這個時間間隔內「撞擊」到這個障礙物（當然因為格子點上有障礙物 的存在，所以珠子其實不會真的滾到障礙物的上面）。而珠子撞到障礙物時會導致 所謂的「反彈」，也就是方向往右（順時針）轉 90 度，但珠子的所在並不移動 （也就是「反彈」只會改變移動方向而已）。值得注意的是，如果沿著牆滾動並不會 導致「撞擊」（直到撞到另一面牆或彈力條）。

珠子的「生命值」表示珠子可以「活」多少個時間間隔（亦即在消失前會出現多久）。 當珠子每移動一格，即需要花一點生命值，而撞擊到牆或彈力條時也會掉一些生命值。 當撞擊到障礙物時，珠子所額外被扣掉的生命值（即被此障礙物「花掉」的生命值） 稱為此障礙物的「花費 (cost)」。 當珠子撞擊到彈力條時，只要其「生命值」是正的，就可以獲得此彈力條的全部分數 (即其「價值」)。所以一顆生命值只剩下 1 的珠子無法藉由撞擊彈力條來得到分數 ，因為在下一個時間間隔此珠子的生命值為 0 ，就會消失。只要珠子的 生命值為非正的(即小於等於 0)，它就會從檯面上消失，而下一個珠子出現繼續 遊戲。(亦即一局裡恰會有一顆珠子)

<!-- more -->

## Input ##

你的程式必須模擬一場上述彈珠檯的遊戲。在輸入裡會有許多行來描述此遊戲的條件。 第一行是兩個整數 m 和 n，中間用一個空白隔開，表示上述矩形檯面 的寬（ x 方向）與長（ y 方向），其中 m , n 的範圍為 2 < m < 51 ， 2 < n < 51.

下一行是撞擊到牆所要的「花費」，為一整數。再下一行是個整數 $ p \geqslant 0 $， 也就是彈力條的個數。然後下面 p 行裡，每一行皆有四個整數代表各個彈力條的 「 x 坐標」、「 y 坐標」、「價值」、「花費」，中間用空白隔開。 其中的 x 坐標、 y 坐標皆在檯面的範圍內。至於「價值」和 「花費」可能是任何的整數（這意味著有可能是負的；而一個負的「花費」表示 增加 珠子的生命值）

輸入裡剩下的幾行則是有關珠子的敘述。每一行皆表示一顆珠子的四個屬性， 依序由四個整數來描述：「初始位置 x 坐標」、 「初始位置 y 坐標」、「初始運動方向」、「初始生命值」。 每個珠子的初始位置皆在檯面的範圍內，而且絕對不會在任何彈力條或是牆的上面。 至於運動方向是由 0 1 2 3 這四個值之一來表示： 0 表右（ x 正向）、 1 表上（ y 正向）、 2 表左（ x 負向）、 3 表下（ y 負向）。而初始生命值為一個正整數。

## Output ##

依照順序，對於輸入裡的每一顆珠子，必須皆有其相對應的一行輸出最後這顆珠子所 得到的分數。將每顆珠子的分數都印出來後，最後還要輸出所有的珠子得到的分數 總和。

## Sample Input ##

	4 4
	0
	2
	2 2 1 0
	3 3 1 0
	2 3 1 1
	2 3 1 2
	2 3 1 3
	2 3 1 4
	2 3 1 5

## Sample Output ##

	0
	0
	1
	2
	2
	5
